# CVE-2021-44228

Use this query to look for a tool launched to exploit the Log4j vulnerability. 

## Details

[Threat Alert: Apache Log4j RCE(CVE-2021-44228) aka Log4Shell](https://www.broadcom.com/support/security-center/protection-bulletin#blt3e71edabe2937935_en-us)

## Query based on events :  

# Java launching exploit

```
type_id:8001 and operation:1 and ( event_actor.file.name:java.exe or event_actor.file.name:javaw.exe ) and ( event_actor.cmd_line:"marshalsec.jndi.LDAPRefServer" and event_actor.cmd_line:"Exploit" )

```

# curl sending crafted strings to log4j

```
type_id:8001 and operation:1 and process.file.name:curl.exe and ( process.cmd_line:"jndi:ldap" or process.cmd_line:"jndi:rmi:" or process.cmd_line:"jndi:http:" or process.cmd_line:"jndi:dns:" or process.cmd_line:"lower:jndi" )

```

## Query on network-based protection

```
quick:"Vantage Detection" and (signature_id:33459 or signature_id:33460 or signature_id:33458 or signature_id:33455)

```

## Query on file-based protection

```
quick:"Antivirus Detection" and ( threat.name:CL.Suspexec!gen106 or threat.name:CL.Suspexec!gen107 or threat.name:CL.Suspexec!gen108 or threat.name:CL.Suspexec!sr109 )

```

## Query on behavior-based protection

```
quick:"SONAR Detection" and (bash.virus_name:SONAR.Maljava!g7 or bash.virus_name:SONAR.Susplaunch!g182 or bash.virus_name:SONAR.Susplaunch!g184 or bash.virus_name:SONAR.SuspLaunch!g186 or bash.virus_name:SONAR.Ransomware!g31 or bash.virus_name:SONAR.Ransomware!g32 or bash.virus_name:SONAR.SuspBeh!gen738)

```
## Note
Kindly update and use latest AV definitions.
The clause used in query might be available in the latest version of the definitions only.
