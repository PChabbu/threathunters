# CVE-2021-40444

Use this query to look for running MSHTML RCE Vulnerability in the environment. 

## Details

[Threat Alert Microsoft MSHTML RCE Vulnerability CVE-2021-40444](https://www.broadcom.com/support/security-center/protection-bulletin#bltda635ffa6868cbde_en-us)

## Query on events

```
(event_actor.file.name:control.exe AND process.file.name:rundll32.exe ) AND ( process.cmd_line:/.*\.inf.*/ OR process.cmd_line:/.*cpl.*/ OR event_actor.cmd_line:/.*\.inf.*/) OR (type_id:8001 AND process.file.name:control.exe AND event_actor.cmd_line:/.*\.docx.*/ ) OR (process.file.name:rundll32.exe AND ( process.cmd_line:/.*cpl.*/ OR process.cmd_line:/.*\.inf.*/ ))

```
## Events breakdown queries
Control.exe launches rundll32 with .inf or .cpl
```
(event_actor.file.name:control.exe AND process.file.name:rundll32.exe ) AND ( process.cmd_line:/.*\.inf.*/ OR process.cmd_line:/.*cpl.*/ OR event_actor.cmd_line:/.*\.inf.*/)

```
Winword.exe launches control.exe
```
type_id:8001 AND process.file.name:control.exe AND event_actor.cmd_line:/.*\.docx.*/ 

```
Rundll32 command line contains 'cpl:' or 'inf'
```
process.file.name:rundll32.exe AND ( process.cmd_line:/.*cpl.*/ OR process.cmd_line:/.*\.inf.*/ )

```
## Query on network-based protection

```
quick:"Vantage Detection" and (signature_id:32428 or signature_id:33278)

```

## Query on file-based protection

```
quick:"Antivirus Detection" and (threat.name:Exp.CVE-2021-40444 or threat.name:Exp.CVE-2021-40444!g1)

```
## Note
Kindly update and use latest AV definitions.
The clause used in query might be available in the latest version of the definitions only.
